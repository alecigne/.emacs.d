#+TITLE: Personal settings - preload

* Table of contents                                            :noexport:toc:
- [[#main-directories-and-files][Main directories and files]]
  - [[#path][Path]]
  - [[#system-info][System info]]
  - [[#subdirectories][Subdirectories]]
  - [[#org-files][Org files]]
- [[#safe-local-variables][Safe local variables]]
- [[#projectile][Projectile]]

* Main directories and files

** Path

#+BEGIN_SRC emacs-lisp :tangle yes
  (when (eq system-type 'gnu/linux)
    (add-to-list 'exec-path "~/.local/bin"))
#+END_SRC

** System info

#+BEGIN_SRC emacs-lisp :tangle yes
  (unless (and (bound-and-true-p alc-root-dir)
               (bound-and-true-p alc-current-system))
    (error "Missing system info."))
#+END_SRC

** Subdirectories

#+BEGIN_SRC emacs-lisp :tangle yes
  (setq alc-org-main-dir (concat alc-root-dir "org/")
        alc-tmp-dir (concat alc-root-dir "tmp/")
        alc-backup-directory (concat alc-tmp-dir "stk/emacs-backup/"))

  (setq alc-website-base-dir (concat alc-root-dir "doc/per/me/Expression/anthony.lecigne.net/")
        alc-website-pub-dir (concat alc-root-dir "pub/anthony.lecigne.net/")
        alc-emacs-config-pub-dir (concat alc-root-dir "pub/emacs-config/"))

  (setq alc-all-dir (list alc-org-main-dir
                          alc-tmp-dir
                          alc-backup-directory
                          alc-website-base-dir
                          alc-website-pub-dir
                          alc-emacs-config-pub-dir))

  (dolist (dir alc-all-dir)
    (unless (file-exists-p dir)
      (make-directory dir t)))
#+END_SRC

** Org files

#+BEGIN_SRC emacs-lisp :tangle yes
  (setq alc-org-todo-file (concat alc-org-main-dir "todo.org")
        alc-org-note-file (concat alc-org-main-dir "notes.org")
        alc-org-entourage-file (concat alc-org-main-dir "Entourage.org"))
#+END_SRC

* Safe local variables

#+BEGIN_SRC emacs-lisp :tangle yes
  (setq safe-local-variable-values
        '((eval add-hook 'after-save-hook
                (lambda () (org-babel-tangle))
                nil t)))

  (put 'org-inlinetask-min-level 'safe-local-variable #'numberp)
#+END_SRC

* Projectile

I encountered some problems with Projectile-related variables when
they were loaded after everything else.

#+BEGIN_SRC emacs-lisp :tangle yes
  (setq projectile-known-projects-file
        (locate-user-emacs-file (concat "projectile/projectile-bookmarks-"
                                        alc-current-system
                                        ".eld")))
  (with-eval-after-load 'projectile
    (setq projectile-indexing-method 'native
          projectile-enable-caching t
          projectile-track-known-projects-automatically nil)

    (setq projectile-cache-file
          (locate-user-emacs-file (concat "projectile/projectile-"
                                          alc-current-system
                                          ".cache"))))
#+END_SRC

